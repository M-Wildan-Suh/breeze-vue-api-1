import{r as c,C as g,c as f,d as i,e as C,w as l,H as P,f as n,J as Q,h as s,s as B,t as y,E as D,G as E,m as v}from"./index-c1909b7c.js";import{u as U}from"./stock-cea63cd5.js";import{Q as V}from"./QrChecker-9a5ff8ea.js";import{_ as j}from"./SuccessMessage-50cc8be4.js";import"./vue-qrcode-reader-8adc1da8.js";const q={class:"w-full space-y-4"},M={class:"bg-light-primary-1 dark:bg-dark-primary-2 p-5 rounded-lg space-y-3 shadow-lg"},N={class:"flex justify-between"},A=s("i",{class:"fa-solid fa-camera dark:text-typography-1"},null,-1),F=[A],G=s("i",{class:"fa-solid fa-check"},null,-1),H=s("p",null,"Save",-1),J=[G,H],O={class:"line-clamp-2"},W=["onUpdate:modelValue"],z={key:1},Z={__name:"Scan",setup(I){const m=U(),_=c(!1),d=c([]),b=g(()=>d.value),h=c([]),k=g(()=>h.value),w=[{key:"product.product_name",title:"Product"},{key:"product_code",title:"Product Code"},{key:"amount",title:"Amount"}],p=c({paused:!1,alert:!1}),o=c({products:[]}),S=async e=>{await m.checkQr(e,o.value.products,d,_,p,h),await T(500)},T=async e=>new Promise(t=>{window.setTimeout(t,e)}),$=async()=>{if(o.value.products.length>0){const e=new FormData;o.value.products.forEach((t,r)=>{e.append(`products[${r}][id]`,t.id),e.append(`products[${r}][product_id]`,t.product_id),e.append(`products[${r}][amount]`,t.amount),e.append(`products[${r}][product_code]`,t.product_code)}),await m.submitToWarehouse(o.value.products,e,d,_)}else d.value=Object.values(["Scan More Than 1 Products"]).flat()};return(e,t)=>{const r=f("v-dialog"),x=f("v-data-table");return i(),C(P,null,{default:l(()=>[n(Q,{class:"w-full",errors:b.value},null,8,["errors"]),n(j,{class:"w-full",messages:k.value},null,8,["messages"]),s("div",q,[s("div",M,[s("div",N,[n(r,null,{activator:l(({props:a})=>[s("button",B({type:"button"},a,{onClick:t[0]||(t[0]=u=>p.value.paused=!1)}),F,16)]),default:l(({isActive:a})=>[s("div",null,[s("div",null,[n(V,{qr:p.value,checkQr:S,result:o.value.products,"onUpdate:result":t[1]||(t[1]=u=>o.value.products=u),show:a},null,8,["qr","result","show"])])])]),_:1}),s("button",{type:"button",onClick:$,class:"bg-secondary-3 hover:bg-opacity-90 !text-light-primary-1 px-3 py-2 rounded-lg text-sm cursor-pointer flex justify-center items-center gap-3"},J)]),n(x,{page:e.pageTable,"onUpdate:page":t[2]||(t[2]=a=>e.pageTable=a),search:e.searchTable,headers:w,items:o.value.products,"hide-default-footer":"","header-props":{class:"dark:bg-dark-primary-1 bg-light-primary-2 dark:!text-white border-b dark:!border-white/30"},"item-key":"id",class:"border dark:!border-typography-2/20 shadow-lg dark:!bg-dark-primary-1 !bg-light-primary-2 dark:!text-typography-1"},{"item.product.product_name":l(({item:a})=>[s("p",O,y(a.product.product_name),1)]),"item.amount":l(({item:a})=>[a.product.product_code_type=="common_code"?D((i(),v("input",{key:0,type:"number",class:"w-20 bg-transparent active:ring-0 focus:ring-0","onUpdate:modelValue":u=>a.amount=u},null,8,W)),[[E,a.amount]]):(i(),v("p",z,y(a.amount),1))]),_:1},8,["page","search","items"])])])]),_:1})}}};export{Z as default};
